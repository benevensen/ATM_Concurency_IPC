Finished with part 6, it works perfectly and exits cleanly. 

It even gets rid of the semaphore and the message queue.

Needs a lot of clean up but is perfectly functional.